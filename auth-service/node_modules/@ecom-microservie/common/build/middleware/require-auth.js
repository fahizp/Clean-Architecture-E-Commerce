"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.requireAuth = void 0;
const not_authorized_error_1 = require("../error/not-authorized-error");
/**
 * Middleware function to check if the user is authenticated.
 * If not, throws NotAuthorizedError. Otherwise, calls the next middleware function.
 */
const requireAuth = (req, res, next) => {
    console.log("Checking authentication...");
    const currentUser = req.currentUser;
    if (!currentUser) {
        console.log('User not authenticated.');
        throw new not_authorized_error_1.NotAuthorizedError();
    }
    console.log(`User ${currentUser.email} authenticated.`);
    next();
};
exports.requireAuth = requireAuth;
